// Clock Tower

aldebaran,0,0,0	script	Clocktower	-1,{
	end;

OnInit:
	if( gettime(3) >= 7 && gettime(3) < 19 )
		day;
	else
		night;
	end;

OnClock0000:
OnClock0100:
OnClock0200:
OnClock0300:
OnClock0400:
OnClock0500:
OnClock0600:
OnClock0700:
OnClock0800:
OnClock0900:
OnClock1000:
OnClock1100:
	set .suffix$, "a.m.";
	goto L_RingBells;
	end;

OnClock1200:
OnClock1300:
OnClock1400:
OnClock1500:
OnClock1600:
OnClock1700:
OnClock1800:
OnClock1900:
OnClock2000:
OnClock2100:
OnClock2200:
OnClock2300:
	set .suffix$, "p.m.";
	goto L_RingBells;
	end;
	
L_RingBells:
	set .Count, 0;
	set .Hour, gettime(3);

	if( .Hour == 7 ) 
		day;
	else if( .Hour == 19 ) 
		night;
	
	if( .Hour > 12 ) 
		set .dispHour, .Hour - 12;
	else if( .Hour == 0 ) 
		set .dispHour, 12;
	else 
		set .dispHour, .Hour;
	
	announce "[Aldebaran Clock Tower - " + .dispHour + " " + .suffix$ + "]",0,0x33CCFF;
	initnpctimer;
	end;

OnTimer1000:
OnTimer3000:
OnTimer5000:
OnTimer7000:
OnTimer9000:
OnTimer11000:
OnTimer13000:
OnTimer15000:
OnTimer17000:
OnTimer19000:
OnTimer21000:
OnTimer23000:
	soundeffectall "effect\\ef_angelus.wav",0,"aldebaran";

	set .Count, .Count + 1;
	if( .Count >= .NHour )
	{
		stopnpctimer;
		set .Count, 0;
	}

	end;
}
